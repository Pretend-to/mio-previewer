<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mermaid 缩放拖动测试</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
    }
    
    h1 {
      color: #333;
      border-bottom: 2px solid #4d94ff;
      padding-bottom: 10px;
    }
    
    .info {
      background: #f0f7ff;
      border-left: 4px solid #4d94ff;
      padding: 15px;
      margin: 20px 0;
      border-radius: 4px;
    }
    
    .info h3 {
      margin-top: 0;
      color: #2d5a9f;
    }
    
    .info ul {
      margin: 10px 0;
      padding-left: 20px;
    }
    
    .info li {
      margin: 5px 0;
    }
    
    #app {
      margin-top: 30px;
    }
    
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 10px 20px;
      background: #4d94ff;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: background 0.3s;
    }
    
    .theme-toggle:hover {
      background: #3d84ef;
    }
    
    /* 暗色主题 */
    .theme-dark body {
      background: #1e1e1e;
      color: #e0e0e0;
    }
    
    .theme-dark h1 {
      color: #e0e0e0;
      border-bottom-color: #4d94ff;
    }
    
    .theme-dark .info {
      background: #2d3748;
      border-left-color: #4d94ff;
    }
    
    .theme-dark .info h3 {
      color: #6b9aff;
    }
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleTheme()">切换主题</button>
  
  <h1>🎨 Mermaid 图表交互功能测试</h1>
  
  <div class="info">
    <h3>✨ 新增功能</h3>
    <ul>
      <li><strong>滚轮缩放：</strong>在图表上滚动鼠标滚轮可以放大/缩小图表（0.1x - 5x）</li>
      <li><strong>拖动移动：</strong>点击并拖动图表可以移动查看位置</li>
      <li><strong>重置缩放：</strong>点击右上角的 ⊕ 按钮重置为初始状态</li>
      <li><strong>全屏预览：</strong>点击右上角的 ⛶ 按钮进入/退出全屏模式</li>
      <li><strong>缩放指示器：</strong>实时显示当前缩放比例</li>
    </ul>
  </div>

  <div id="app"></div>

  <script type="module">
    import { createApp, ref } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js'
    import MdRenderer from './src/MdRenderer.vue'

    const markdownContent = `
# Mermaid 图表交互测试

以下是一个复杂的流程图示例，展示了新增的缩放和拖动功能：

\`\`\`mermaid
graph TB
    A[开始] --> B{是否需要缩放?}
    B -->|是| C[使用鼠标滚轮]
    B -->|否| D{是否需要移动?}
    C --> E[放大查看细节]
    C --> F[缩小查看全局]
    D -->|是| G[点击并拖动图表]
    D -->|否| H[点击全屏按钮]
    E --> I[继续操作]
    F --> I
    G --> I
    H --> J[全屏查看]
    J --> K[按ESC退出全屏]
    K --> L[点击重置按钮]
    L --> M[恢复初始状态]
    M --> N[结束]
    I --> B
    
    style A fill:#e1f5e1
    style N fill:#ffe1e1
    style H fill:#e1e5ff
    style J fill:#e1e5ff
\`\`\`

## 时序图示例

\`\`\`mermaid
sequenceDiagram
    participant U as 用户
    participant M as Mermaid组件
    participant B as 浏览器
    
    U->>M: 滚动鼠标滚轮
    M->>M: 计算缩放比例
    M->>B: 更新 transform
    B-->>U: 显示缩放效果
    
    U->>M: 拖动图表
    M->>M: 计算位移
    M->>B: 更新 translate
    B-->>U: 显示移动效果
    
    U->>M: 点击全屏按钮
    M->>B: 请求全屏
    B-->>U: 进入全屏模式
    
    U->>M: 点击重置按钮
    M->>M: 重置 scale 和 translate
    M->>B: 更新 transform
    B-->>U: 恢复初始状态
\`\`\`

## 类图示例

\`\`\`mermaid
classDiagram
    class MermaidDiagram {
        +scale: number
        +translateX: number
        +translateY: number
        +isDragging: boolean
        +isFullscreen: boolean
        +handleWheel(e)
        +handleMouseDown(e)
        +handleMouseMove(e)
        +resetZoom()
        +toggleFullscreen()
    }
    
    class ZoomController {
        +minScale: number
        +maxScale: number
        +zoomIn()
        +zoomOut()
        +setScale(scale)
    }
    
    class DragController {
        +startX: number
        +startY: number
        +startDrag(e)
        +drag(e)
        +endDrag()
    }
    
    MermaidDiagram --> ZoomController
    MermaidDiagram --> DragController
\`\`\`
`

    const app = createApp({
      components: { MdRenderer },
      setup() {
        const markdown = ref(markdownContent)
        return { markdown }
      },
      template: '<MdRenderer :md="markdown" />'
    })

    app.mount('#app')
  </script>

  <script>
    function toggleTheme() {
      document.documentElement.classList.toggle('theme-dark')
      document.body.classList.toggle('theme-dark')
    }
  </script>
</body>
</html>
